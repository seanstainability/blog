---
date: '2020-07-29'
title: 'JamStack'
categories: ['Web', 'JamStack', 'Architecture']
summary: '홈페이지를 운영하는 많은 사람들 또는 기업들이 검색 페이지 최상단에 보여지게 하기 위해 어떤 최적화 작업을 하는지 알아보자.'
thumbnail: './test.png'
---

# JamStack

## JamStack이란?

자바스크립트, API, 마크업 조합

## 전통적인 웹 개발 방식은?

![jamstack](https://d33wubrfki0l68.cloudfront.net/b7d16f7f3654fb8572360301e60d76df254a323e/385ec/img/svg/architecture.svg)

- DB나 CMS([워드프레스](https://wordpress.org/))를 사용하여 앱에 필요한 데이터를 조회하거나 저장한다.
- 앱 서버에서는 다양한 비즈니스 로직(유저가 원하는 데이터를 생성해주는 코드) 처리를 한다.
- 웹 서버에서는 데이터를 사용하여 HTML 페이지를 만들거나 이미지나 폰트 같은 정적 자원을 브라우저에 전달하는 역할을 한다.

계층들이 강하게 결합되어 있어 의존도가 높고, 별도의 서버 운영에 들어가는 비용이 크다. → **서버리스** 등장

## 서버리스

- 서버 시스템을 가상의 클라우드 환경에 두고 운영한다.
- 서버를 내가 만들 필요가 없다. → 인프라 및 유지보수에 들어가는 비용 절감, 필요한 API, 비즈니스 로직에만 집중할 수 있어 생산성 향상
- 각각의 계층이 독립적인 서비스 형태로 사용할 수 있게 변화하였다.
  - Amazon DynamoDB, FaunaDB와 같은 DB 관리 서비스들이 기존의 DB를 대체
  - Function 단위의 API 서비스들이 기존의 앱 서버를 대체 → AWS Lambda, Firebase Cloud Functions, Netlify Functions
- JamStack도 서버리스 개발 구조에서 파생되었다.

## JamStack

동적 요소 처리(API 요청 등)를 위한 자바스크립트 + 재사용 가능한 API + 사전 생성된 페이지(Prebuilt Pages) → 서버 없이 배포 운영되는 웹 개발 구조

일반적으로 정적 사이트 생성기(Static Site Generator)를 사용해서 개발하고 빌드하여 정적인 페이지들을 생성(페이지 사전 생성, Pre-Render)
→ 생성된 결과물을 CDN(Content Delivery Network)을 통해 전송

## 장점

1. 높은 안정성(Secure)
   - 동적으로 변경되는 부분이 적다.
   - 서버나 DB의 실행이 필요하지 않기 때문에 공격에 노출되는 범위가 적다.
2. 빠른 성능(Fast)
   - 보여줄 콘텐츠가 페이지로 미리 생성되어 있어 빠르게 렌더링할 수 있다.
   - 브라우저에서 첫 응답을 받기까지 걸리는 시간인 TTFB(Time to First Byte)를 최소화하는 데에는 미리 빌드 된 파일을 CDN을 통해 제공하는 것보다 나은 방법이 없다.
   - CDN이 제공하는 캐시의 이점도 누릴 수 있다.
3. 뛰어난 확장성과 낮은 비용(Easy to scale)
   - 전 세계 어디든 CDN을 통해 손쉽게 확장 가능하다.
   - 정적인 HTML 페이지 호스팅 비용은 저렴한 편이다.
4. 빌드 및 배포 과정을 손쉽게 자동화(Esay to automate)
   - 빌드 산출물이 단순한 정적 페이지들이라 배포 과정이 단순하다. 정적 자산을 호스팅 서비스에 제공하기만 하면 된다.

## Gatsby 동작 흐름

React 기반의 정적 사이트 생성기

1. 다양한 타입의 데이터 소스(Markdown, JSON, CMS 등)가 Gatsby 플러그인 시스템을 통해 GraphQL 노드로 변환된다.
   - 마크다운의 메타 정보들이 GraphQL 노드의 필드로 변환된다.
2. 변환된 GraphQL 노드 데이터는 GraphQL 쿼리로 조회가 가능하고, React 컴포넌트에서는 props를 통해 조회된 데이터에 접근할 수 있다.
3. 빌드 시 React 컴포넌트들을 조합하여 페이지를 생성한다.
   - GraphQL 쿼리를 실행하여 조회된 데이터는 빌드 시 컴포넌트의 콘텐츠로 사용된다.

## JamStack 생태계

검색, 쇼핑, 결제 등 다양한 Third party APIs : algolia(검색 API 서비스), shopify, PayPal

예로, algolia plugin을 사용하면 빌드 시 검색 대상 콘텐츠들을 algolia 서비스의 검색 대상 레코드(필드)로 등록할 수 있다.  
검색 시에도 React 검색 컴포넌트를 통해 검색어가 입력될 때마다 algolia 서비스에 검색 쿼리 API를 요청하게 되고, API 결과로 검색된 결과를 받아 React 검색 결과 리스트 컴포넌트로 보여줄 수 있다.

## 단점

1. 빌드 속도
   - 페이지 양이 많아질수록 빌드 시간이 증가한다.
2. 짧은 실시간 단위로 콘텐츠를 변경해야 하는 경우 반영이 느림
   - 콘텐츠 변경 사항을 반영하기 위해서는 빌드를 수행해야 하는데 빌드 속도가 느린 경우에는 즉각즉각 반영하기 힘들다.
   - 빌드 타임 개선을 위해 Gatsby, Next.js에서는 '점진적 빌드(변경된 부분만 빌드해서 해당 페이지만 다시 생성하는 기술)'라는 실험적인 기능을 발전시켜 나가는 중
